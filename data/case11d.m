function mpc = case11
%%AUTHORS:Meisam Mahdavi, Hassan Haes Alhelou, Paul Cuffe
%%PAPER TITLE:"Test Systems for Reconfiguration and Operation of Electric Power Distribution Networks"
%CASE11:TEST SYSTEM 11: "DISTRIBUTION NETWORK OF TAIWAN POWER COMPANY (TPC)"
%
%  DATA from our paper: "Test Systems for Reconfiguration and Operation of Electric Power Distribution Networks" 
%      
% 
%  02/02/2021       DISTRIBUTION NETWORK OF TAIWAN POWER COMPANY (TPC) By H.H. Alhelou & P.Cuffe

%   MATPOWER

%% MATPOWER Case Format : Version 2
mpc.version = '2';


%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 0.1;
%% system MVA base
Vnom  = 11.4;	%Nominal line voltage (kV)
Vbase = 11.4;	%Base line voltage (kV)
Sbase = 100;	%3-Phase base power (kVA)

%%%NOTE: Bus84(A,B,C,D,F)&Bus85(G,H,I,J,K)=Connection with trnasmission systems.

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [ %% (Pd and Qd are specified in kW & kVAr here, converted to MW & MVAr below)
		1	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		2	1		100		50  0	0	1	1	0	11.4	1	1.05	0.95;
		3	1		300		200  0	0	1	1	0	11.4	1	1.05	0.95;
		4	1		350		250  0	0	1	1	0	11.4	1	1.05	0.95;
		5	1		220		100  0	0	1	1	0	11.4	1	1.05	0.95;
		6	1		1100	800  0	0	1	1	0	11.4	1	1.05	0.95;
		7	1		400		320  0	0	1	1	0	11.4	1	1.05	0.95;
		8	1		300		200  0	0	1	1	0	11.4	1	1.05	0.95;
		9	1		300		230  0	0	1	1	0	11.4	1	1.05	0.95;
		10	1		300		260  0	0	1	1	0	11.4	1	1.05	0.95;
		11	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		12	1		1200	800  0	0	1	1	0	11.4	1	1.05	0.95;
		13	1		800		600  0	0	1	1	0	11.4	1	1.05	0.95;
		14	1		700		500  0	0	1	1	0	11.4	1	1.05	0.95;
		15	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		16	1		300		150  0	0	1	1	0	11.4	1	1.05	0.95;
		17	1		500		350  0	0	1	1	0	11.4	1	1.05	0.95;
		18	1		700		400  0	0	1	1	0	11.4	1	1.05	0.95;
		19	1		1200	1000  0	0	1	1	0	11.4	1	1.05	0.95;
		20	1		300		300  0	0	1	1	0	11.4	1	1.05	0.95;
		21	1		400		350  0	0	1	1	0	11.4	1	1.05	0.95;
		22	1		50		20  0	0	1	1	0	11.4	1	1.05	0.95;
		23	1		50		20  0	0	1	1	0	11.4	1	1.05	0.95;
		24	1		50		10  0	0	1	1	0	11.4	1	1.05	0.95;
		25	1		50		30  0	0	1	1	0	11.4	1	1.05	0.95;
		26	1		100		60  0	0	1	1	0	11.4	1	1.05	0.95;
		27	1		100		70  0	0	1	1	0	11.4	1	1.05	0.95;
		28	1		1800	1300  0	0	1	1	0	11.4	1	1.05	0.95;
		29	1		200		120  0	0	1	1	0	11.4	1	1.05	0.95;
		30	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		31	1		1800	1600  0	0	1	1	0	11.4	1	1.05	0.95;
		32	1		200		150  0	0	1	1	0	11.4	1	1.05	0.95;
		33	1		200		100  0	0	1	1	0	11.4	1	1.05	0.95;
		34	1		800		600  0	0	1	1	0	11.4	1	1.05	0.95;
		35	1		100		60  0	0	1	1	0	11.4	1	1.05	0.95;
		36	1		100		60  0	0	1	1	0	11.4	1	1.05	0.95;
		37	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		38	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		39	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		40	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		41	1		200		160  0	0	1	1	0	11.4	1	1.05	0.95;
		42	1		50		30  0	0	1	1	0	11.4	1	1.05	0.95;
		43	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		44	1		30		20  0	0	1	1	0	11.4	1	1.05	0.95;
		45	1		800		700  0	0	1	1	0	11.4	1	1.05	0.95;
		46	1		200		150  0	0	1	1	0	11.4	1	1.05	0.95;
		47	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		48	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		49	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		50	1		200		160  0	0	1	1	0	11.4	1	1.05	0.95;
		51	1		800		600  0	0	1	1	0	11.4	1	1.05	0.95;
		52	1		500		300  0	0	1	1	0	11.4	1	1.05	0.95;
		53	1		500		350  0	0	1	1	0	11.4	1	1.05	0.95;
		54	1		500		300  0	0	1	1	0	11.4	1	1.05	0.95;
		55	1		200		80  0	0	1	1	0	11.4	1	1.05	0.95;
		56	1		0		0   0	0	1	1	0	11.4	1	1.05	0.95;
		57	1		30		20  0	0	1	1	0	11.4	1	1.05	0.95;
		58	1		600		420  0	0	1	1	0	11.4	1	1.05	0.95;
		59	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		60	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		61	1		20		10  0	0	1	1	0	11.4	1	1.05	0.95;
		62	1		200		130  0	0	1	1	0	11.4	1	1.05	0.95;
		63	1		300		240  0	0	1	1	0	11.4	1	1.05	0.95;
		64	1		300		200  0	0	1	1	0	11.4	1	1.05	0.95;
		65	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		66	1		50		30  0	0	1	1	0	11.4	1	1.05	0.95;
		67	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		68	1		400		360  0	0	1	1	0	11.4	1	1.05	0.95;
		69	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		70	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		71	1		2000	1500  0	0	1	1	0	11.4	1	1.05	0.95;
		72	1		200		150  0	0	1	1	0	11.4	1	1.05	0.95;
		73	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		74	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		75	1		1200	950  0	0	1	1	0	11.4	1	1.05	0.95;
		76	1		300		180  0	0	1	1	0	11.4	1	1.05	0.95;
		77	1		0		0  0	0	1	1	0	11.4	1	1.05	0.95;
		78	1		400		360  0	0	1	1	0	11.4	1	1.05	0.95;
		79	1		2000	1300  0	0	1	1	0	11.4	1	1.05	0.95;
		80	1		200		140  0	0	1	1	0	11.4	1	1.05	0.95;
		81	1		500		360  0	0	1	1	0	11.4	1	1.05	0.95;
		82	1		100		30  0	0	1	1	0	11.4	1	1.05	0.95;
		83	1		400		360  0	0	1	1	0	11.4	1	1.05	0.95;
        84	3		0		0  0	0	1	1	0	11.4	1	1	1;
        85	3		0		0  0	0	1	1	0	11.4	1	1	1;
];


%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	84	0	0	10	-10	1	100	1	10	0	0	0	0	0	0	0	0	0	0	0	0;
    85	0	0	10	-10	1	100	1	10	0	0	0	0	0	0	0	0	0	0	0	0;
];
%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [  %% (r and x specified in ohms here, converted to p.u. below)
		1	84		0.1944		0.6624	0	0	0	0	0	0	1	-360	360;
		1	2		0.2096		0.4304	0	0	0	0	0	0	1	-360	360;
		2	3		0.2358		0.4842	0	0	0	0	0	0	1	-360	360;
		3	4		0.0917		0.1883	0	0	0	0	0	0	1	-360	360;
		4	5		0.2096		0.4304	0	0	0	0	0	0	1	-360	360;
		5	6		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		6	7		0.0405		0.1380	0	0	0	0	0	0	1	-360	360;
		7	8		0.1048		0.2152	0	0	0	0	0	0	1	-360	360;
		7	9		0.2358		0.4842	0	0	0	0	0	0	1	-360	360;
		7	10		0.1048		0.2152	0	0	0	0	0	0	1	-360	360;
		11	84		0.0786		0.1614	0	0	0	0	0	0	1	-360	360;
		11	12		0.3406		0.6944	0	0	0	0	0	0	1	-360	360;
		12	13		0.0262		0.0538	0	0	0	0	0	0	1	-360	360;
		12	14		0.0786		0.1614	0	0	0	0	0	0	1	-360	360;
		15	84		0.1134		0.3864	0	0	0	0	0	0	1	-360	360;
		15	16		0.0524		0.1076	0	0	0	0	0	0	1	-360	360;
		16	17		0.0524		0.1076	0	0	0	0	0	0	1	-360	360;
		17	18		0.1572		0.3228	0	0	0	0	0	0	1	-360	360;
		18	19		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		19	20		0.1703		0.3497	0	0	0	0	0	0	1	-360	360;
		20	21		0.2358		0.4842	0	0	0	0	0	0	1	-360	360;
		21	22		0.1572		0.3228	0	0	0	0	0	0	1	-360	360;
		21	23		0.1965		0.4035	0	0	0	0	0	0	1	-360	360;
		23	24		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		25	84		0.0567		0.1932	0	0	0	0	0	0	1	-360	360;
		25	26		0.1048		0.2152	0	0	0	0	0	0	1	-360	360;
		26	27		0.2489		0.5111	0	0	0	0	0	0	1	-360	360;
		27	28		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		28	29		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		30	84		0.1965		0.3960	0	0	0	0	0	0	1	-360	360;
		30	31		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		31	32		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		32	33		0.0262		0.0538	0	0	0	0	0	0	1	-360	360;
		33	34		0.1703		0.3497	0	0	0	0	0	0	1	-360	360;
		34	35		0.0524		0.1076	0	0	0	0	0	0	1	-360	360;
		35	36		0.4978		1.0222	0	0	0	0	0	0	1	-360	360;
		36	37		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		37	38		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		38	39		0.0786		0.1614	0	0	0	0	0	0	1	-360	360;
		39	40		0.2096		0.4304	0	0	0	0	0	0	1	-360	360;
		38	41		0.1965		0.4035	0	0	0	0	0	0	1	-360	360;
		41	42		0.2096		0.4304	0	0	0	0	0	0	1	-360	360;
		43	84		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		43	44		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		44	45		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		45	46		0.2358		0.4842	0	0	0	0	0	0	1	-360	360;
		47	85		0.2430		0.8280	0	0	0	0	0	0	1	-360	360;
		47	48		0.0655		0.1345	0	0	0	0	0	0	1	-360	360;
		48	49		0.0655		0.1345	0	0	0	0	0	0	1	-360	360;
		49	50		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		50	51		0.0786		0.1614	0	0	0	0	0	0	1	-360	360;
		51	52		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		52	53		0.0786		0.1614	0	0	0	0	0	0	1	-360	360;
		53	54		0.0524		0.1076	0	0	0	0	0	0	1	-360	360;
		54	55		0.1310		0.2690	0	0	0	0	0	0	1	-360	360;
		56	85		0.2268		0.7728	0	0	0	0	0	0	1	-360	360;
		56	57		0.5371		1.1029	0	0	0	0	0	0	1	-360	360;
		57	58		0.0524		0.1076	0	0	0	0	0	0	1	-360	360;
		58	59		0.0405		0.1380	0	0	0	0	0	0	1	-360	360;
		59	60		0.0393		0.0807	0	0	0	0	0	0	1	-360	360;
		60	61		0.0262		0.0538	0	0	0	0	0	0	1	-360	360;
		61	62		0.1048		0.2152	0	0	0	0	0	0	1	-360	360;
		62	63		0.2358		0.4842	0	0	0	0	0	0	1	-360	360;
		63	64		0.0243		0.0828	0	0	0	0	0	0	1	-360	360;
		65	85		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		65	66		0.1703		0.3497	0	0	0	0	0	0	1	-360	360;
		66	67		0.1215		0.4140	0	0	0	0	0	0	1	-360	360;
		67	68		0.2187		0.7452	0	0	0	0	0	0	1	-360	360;
		68	69		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		69	70		0.0729		0.2484	0	0	0	0	0	0	1	-360	360;
		70	71		0.0567		0.1932	0	0	0	0	0	0	1	-360	360;
		71	72		0.0262		0.0528	0	0	0	0	0	0	1	-360	360;
		73	85		0.3240		1.1040	0	0	0	0	0	0	1	-360	360;
		73	74		0.0324		0.1104	0	0	0	0	0	0	1	-360	360;
		74	75		0.0567		0.1932	0	0	0	0	0	0	1	-360	360;
		75	76		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		77	85		0.2511		0.8556	0	0	0	0	0	0	1	-360	360;
		77	78		0.1296		0.4416	0	0	0	0	0	0	1	-360	360;
		78	79		0.0486		0.1656	0	0	0	0	0	0	1	-360	360;
		79	80		0.1310		0.2640	0	0	0	0	0	0	1	-360	360;
		80	81		0.1310		0.2640	0	0	0	0	0	0	1	-360	360;
		81	82		0.0917		0.1883	0	0	0	0	0	0	1	-360	360;
		82	83		0.3144		0.6456	0	0	0	0	0	0	1	-360	360;
		5	55		0.1310		0.2690	0	0	0	0	0	0	0	-360	360;
		7	60		0.1310		0.2690	0	0	0	0	0	0	0	-360	360;
		11	43		0.1310		0.2690	0	0	0	0	0	0	0	-360	360;
		12	72		0.3406		0.6994	0	0	0	0	0	0	0	-360	360;
		13	76		0.4585		0.9415	0	0	0	0	0	0	0	-360	360;
		14	18		0.5371		1.0824	0	0	0	0	0	0	0	-360	360;
		16	26		0.0917		0.1883	0	0	0	0	0	0	0	-360	360;
		20	83		0.0786		0.1614	0	0	0	0	0	0	0	-360	360;
		28	32		0.0524		0.1076	0	0	0	0	0	0	0	-360	360;
		29	39		0.0786		0.1614	0	0	0	0	0	0	0	-360	360;
		34	46		0.0262		0.0538	0	0	0	0	0	0	0	-360	360;
		40	42		0.1965		0.4035	0	0	0	0	0	0	0	-360	360;
		53	64		0.0393		0.0807	0	0	0	0	0	0	0	-360	360;
];


%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0	20	0;
    2	0	0	3	0	20	0;
];


%% convert branch impedances from Ohms to p.u.
[PQ, PV, REF, NONE, BUS_I, BUS_TYPE, PD, QD, GS, BS, BUS_AREA, VM, ...
    VA, BASE_KV, ZONE, VMAX, VMIN, LAM_P, LAM_Q, MU_VMAX, MU_VMIN] = idx_bus;
[F_BUS, T_BUS, BR_R, BR_X, BR_B, RATE_A, RATE_B, RATE_C, ...
    TAP, SHIFT, BR_STATUS, PF, QF, PT, QT, MU_SF, MU_ST, ...
    ANGMIN, ANGMAX, MU_ANGMIN, MU_ANGMAX] = idx_brch;
Vbase = mpc.bus(1, BASE_KV) * 1e3;      %% in Volts
Sbase = mpc.baseMVA * 1e6;              %% in VA
mpc.branch(:, [BR_R BR_X]) = mpc.branch(:, [BR_R BR_X]) / (Vbase^2 / Sbase);

%% convert loads from kW to MW
mpc.bus(:, [PD, QD]) = mpc.bus(:, [PD, QD]) / 1e3;





