function mpc = case7
%%AUTHORS:Meisam Mahdavi, Hassan Haes Alhelou, Paul Cuffe
%%PAPER TITLE:"Test Systems for Reconfiguration and Operation of Electric Power Distribution Networks"
%CASE7:TEST SYSTEM 7: "49-BUS DISTRIBUTION NETWORK"
%
%  DATA from our paper: "Test Systems for Reconfiguration and Operation of Electric Power Distribution Networks" 
%      
% 
%  02/02/2021       49-BUS DISTRIBUTION NETWORK    By H.H. Alhelou & P.Cuffe

%   MATPOWER


%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 0.1;
%% system MVA base
Vnom  = 11;	%Nominal line voltage (kV)
Vbase = 11;	%Base line voltage (kV)
Sbase = 100;	%3-Phase base power (kVA)
%%%NOTE Bus0=bus49

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [ %% (Pd and Qd are specified in kW & kVAr here, converted to MW & MVAr below)
		49	3		0.00000		0.00000 0	0	1	1	0	11	1	1.1	0.9;
		1	1		0.00000		0.00000	0	0	1	1	0	11	1	1.1	0.9;
		2	1		969.679		469.637	0	0	1	1	0	11	1	1.1	0.9;
		3	1		401.246		194.333	0	0	1	1	0	11	1	1.1	0.9;
		4	1		100.311		48.582	0	0	1	1	0	11	1	1.1	0.9;
		5	1		401.246		194.333	0	0	1	1	0	11	1	1.1	0.9;
		6	1		1003.11		485.832	0	0	1	1	0	11	1	1.1	0.9;
		7	1		936.243		453.470	0	0	1	1	0	11	1	1.1	0.9;
		8	1		735.619		356.284	0	0	1	1	0	11	1	1.1	0.9;
		9	1		869.369		421.054	0	0	1	1	0	11	1	1.1	0.9;
		10	1		1270.61		615.388	0	0	1	1	0	11	1	1.1	0.9;
		11	1		922.058		446.572	0	0	1	1	0	11	1	1.1	0.9;
		12	1		1276.69		618.332	0	0	1	1	0	11	1	1.1	0.9;
		13	1		638.347		309.166	0	0	1	1	0	11	1	1.1	0.9;
		14	1		2908.02		1408.41	0	0	1	1	0	11	1	1.1	0.9;
		15	1		922.058		446.572	0	0	1	1	0	11	1	1.1	0.9;
		16	1		425.565		48.7060	0	0	1	1	0	11	1	1.1	0.9;
		17	1		1791.42		867.626	0	0	1	1	0	11	1	1.1	0.9;
		18	1		1264.53		612.442	0	0	1	1	0	11	1	1.1	0.9;
		19	1		948.402		459.332	0	0	1	1	0	11	1	1.1	0.9;
		20	1		421.512		204.147	0	0	1	1	0	11	1	1.1	0.9;
		21	1		1896.80		918.663	0	0	1	1	0	11	1	1.1	0.9;
		22	1		1686.04		816.590	0	0	1	1	0	11	1	1.1	0.9;
		23	1		316.134		153.110	0	0	1	1	0	11	1	1.1	0.9;
		24	1		1053.78		510.368	0	0	1	1	0	11	1	1.1	0.9;
		25	1		632.267		306.220	0	0	1	1	0	11	1	1.1	0.9;
		26	1		559.313		270.888	0	0	1	1	0	11	1	1.1	0.9;
		27	1		838.970		406.332	0	0	1	1	0	11	1	1.1	0.9;
		28	1		1258.45		609.499	0	0	1	1	0	11	1	1.1	0.9;
		29	1		1258.45		609.499	0	0	1	1	0	11	1	1.1	0.9;
		30	1		1817.77		880.386	0	0	1	1	0	11	1	1.1	0.9;
		31	1		2237.25		1083.55	0	0	1	1	0	11	1	1.1	0.9;
		32	1		1817.77		880.38	0	0	1	1	0	11	1	1.1	0.9;
		33	1		1957.59		948.108	0	0	1	1	0	11	1	1.1	0.9;
		34	1		1957.59		948.108	0	0	1	1	0	11	1	1.1	0.9;
		35	1		607.950		294.444	0	0	1	1	0	11	1	1.1	0.9;
		36	1		1925.17		932.40	0	0	1	1	0	11	1	1.1	0.9;
		37	1		303.975		147.221	0	0	1	1	0	11	1	1.1	0.9;
		38	1		3343.72		1619.44	0	0	1	1	0	11	1	1.1	0.9;
		39	1		222.915		107.962	0	0	1	1	0	11	1	1.1	0.9;
		40	1		719.407		348.425	0	0	1	1	0	11	1	1.1	0.9;
		41	1		1726.57		836.220	0	0	1	1	0	11	1	1.1	0.9;
		42	1		1582.69		766.535	0	0	1	1	0	11	1	1.1	0.9;
		43	1		3597.03		1742.12	0	0	1	1	0	11	1	1.1	0.9;
		44	1		2877.63		1393.69	0	0	1	1	0	11	1	1.1	0.9;
		45	1		3884.79		1881.49	0	0	1	1	0	11	1	1.1	0.9;
		46	1		4677.46		2265.39	0	0	1	1	0	11	1	1.1	0.9;
		47	1		1491.50		722.367	0	0	1	1	0	11	1	1.1	0.9;
		48	1		1750.89		847.99	0	0	1	1	0	11	1	1.1	0.9;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	49	0	0	10	-10	1	100	1	10	0	0	0	0	0	0	0	0	0	0	0	0;
];
%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [  %% (r and x specified in ohms here, converted to p.u. below)
		49	1		0.00310		0.00220		0	0	0	0	0	0	1	-360	360;
		1	2		0.00310		0.00220		0	0	0	0	0	0	1	-360	360;
		2	3		0.7440		0.5470		0	0	0	0	0	0	1	-360	360;
		3	4		0.8680		0.6380		0	0	0	0	0	0	1	-360	360;
		4	5		0.4340		0.3190		0	0	0	0	0	0	1	-360	360;
		5	6		0.1628		0.1200		0	0	0	0	0	0	1	-360	360;
		6	7		0.6200		0.4600		0	0	0	0	0	0	1	-360	360;
		7	8		0.5890		0.4330		0	0	0	0	0	0	1	-360	360;
		8	9		0.3570		0.2620		0	0	0	0	0	0	1	-360	360;
		9	10		1.0186		1.0137		0	0	0	0	0	0	1	-360	360;
		1	11		0.0434		0.0319		0	0	0	0	0	0	1	-360	360;
		11	12		1.0171		1.0125		0	0	0	0	0	0	1	-360	360;
		12	13		0.4340		0.3190		0	0	0	0	0	0	1	-360	360;
		13	14		1.0403		1.0296		0	0	0	0	0	0	1	-360	360;
		14	15		0.3660		0.2690		0	0	0	0	0	0	1	-360	360;
		15	16		0.1860		0.1370		0	0	0	0	0	0	1	-360	360;
		1	17		0.0233		0.0171		0	0	0	0	0	0	1	-360	360;
		17	18		0.3880		0.2850		0	0	0	0	0	0	1	-360	360;
		18	19		0.2790		0.2050		0	0	0	0	0	0	1	-360	360;
		19	20		0.5520		0.4050		0	0	0	0	0	0	1	-360	360;
		20	21		0.3970		0.2920		0	0	0	0	0	0	1	-360	360;
		21	22		1.0233		1.0171		0	0	0	0	0	0	1	-360	360;
		22	23		0.0780		0.0570		0	0	0	0	0	0	1	-360	360;
		23	24		0.9900		0.7300		0	0	0	0	0	0	1	-360	360;
		24	25		0.9900		0.7300		0	0	0	0	0	0	1	-360	360;
		1	26		0.0160		0.0120		0	0	0	0	0	0	1	-360	360;
		26	27		0.3720		0.2730		0	0	0	0	0	0	1	-360	360;
		27	28		0.4400		0.3230		0	0	0	0	0	0	1	-360	360;
		28	29		0.3660		0.2690		0	0	0	0	0	0	1	-360	360;
		29	30		0.4500		0.3300		0	0	0	0	0	0	1	-360	360;
		30	31		0.2950		0.2160		0	0	0	0	0	0	1	-360	360;
		31	32		0.2850		0.2100		0	0	0	0	0	0	1	-360	360;
		32	33		0.4590		0.3370		0	0	0	0	0	0	1	-360	360;
		33	34		1.0217		1.0160		0	0	0	0	0	0	1	-360	360;
		1	35		0.0372		0.0273		0	0	0	0	0	0	1	-360	360;
		35	36		0.2880		0.2120		0	0	0	0	0	0	1	-360	360;
		36	37		0.4190		0.3080		0	0	0	0	0	0	1	-360	360;
		37	38		0.4030		0.2960		0	0	0	0	0	0	1	-360	360;
		38	39		0.8680		0.6380		0	0	0	0	0	0	1	-360	360;
		1	40		0.0620		0.0456		0	0	0	0	0	0	1	-360	360;
		40	41		0.2110		0.1550		0	0	0	0	0	0	1	-360	360;
		41	42		0.2170		0.1600		0	0	0	0	0	0	1	-360	360;
		42	43		0.4190		0.3080		0	0	0	0	0	0	1	-360	360;
		43	44		1.0388		1.0285		0	0	0	0	0	0	1	-360	360;
		44	45		0.6360		0.4670		0	0	0	0	0	0	1	-360	360;
		45	46		1.0140		0.6105		0	0	0	0	0	0	1	-360	360;
		1	47		0.1023		0.0752		0	0	0	0	0	0	1	-360	360;
		47	48		0.0285		0.0210		0	0	0	0	0	0	1	-360	360;
		10	16		0.388		0.285		0	0	0	0	0	0	1	-360	360;
		25	34		0.118		0.087		0	0	0	0	0	0	1	-360	360;
		39	46		0.481		0.353		0	0	0	0	0	0	0	-360	360;
		39	48		0.837		0.615		0	0	0	0	0	0	0	-360	360;
		46	48		0.357		0.262		0	0	0	0	0	0	0	-360	360;
];


%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0	20	0;
];


%% convert branch impedances from Ohms to p.u.
[PQ, PV, REF, NONE, BUS_I, BUS_TYPE, PD, QD, GS, BS, BUS_AREA, VM, ...
    VA, BASE_KV, ZONE, VMAX, VMIN, LAM_P, LAM_Q, MU_VMAX, MU_VMIN] = idx_bus;
[F_BUS, T_BUS, BR_R, BR_X, BR_B, RATE_A, RATE_B, RATE_C, ...
    TAP, SHIFT, BR_STATUS, PF, QF, PT, QT, MU_SF, MU_ST, ...
    ANGMIN, ANGMAX, MU_ANGMIN, MU_ANGMAX] = idx_brch;
Vbase = mpc.bus(1, BASE_KV) * 1e3;      %% in Volts
Sbase = mpc.baseMVA * 1e6;              %% in VA
mpc.branch(:, [BR_R BR_X]) = mpc.branch(:, [BR_R BR_X]) / (Vbase^2 / Sbase);

%% convert loads from kW to MW
mpc.bus(:, [PD, QD]) = mpc.bus(:, [PD, QD]) / 1e3;



